# Android开发环境安装指南

## 📋 概述

要成功构建APK，您需要安装以下组件：
- Android Studio（推荐）或 Android SDK
- Java JDK 8+

## 🚀 快速安装（推荐方法）

### 方法一：安装Android Studio（最简单）

1. **下载Android Studio**
   ```bash
   # 访问官网下载
   open https://developer.android.com/studio
   ```

2. **安装Android Studio**
   - 下载完成后，打开dmg文件
   - 将Android Studio拖拽到Applications文件夹
   - 首次启动会自动下载SDK

3. **配置环境变量**
   ```bash
   # 编辑shell配置文件
   nano ~/.zshrc  # 或 ~/.bash_profile
   
   # 添加以下内容
   export ANDROID_HOME=$HOME/Library/Android/sdk
   export PATH=$PATH:$ANDROID_HOME/tools
   export PATH=$PATH:$ANDROID_HOME/platform-tools
   
   # 重新加载配置
   source ~/.zshrc  # 或 source ~/.bash_profile
   ```

### 方法二：使用Homebrew安装

1. **安装Homebrew（如果未安装）**
   ```bash
   /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
   ```

2. **安装Android SDK**
   ```bash
   # 安装Android SDK命令行工具
   brew install --cask android-sdk
   
   # 或者安装Android Studio
   brew install --cask android-studio
   ```

3. **设置环境变量**
   ```bash
   echo 'export ANDROID_HOME=/usr/local/share/android-sdk' >> ~/.zshrc
   echo 'export PATH=$PATH:$ANDROID_HOME/tools:$ANDROID_HOME/platform-tools' >> ~/.zshrc
   source ~/.zshrc
   ```

## 🔧 手动安装SDK

### 1. 下载SDK命令行工具

```bash
# 创建Android目录
mkdir -p ~/Library/Android/sdk
cd ~/Library/Android/sdk

# 下载命令行工具
curl -O https://dl.google.com/android/repository/commandlinetools-mac-9477386_latest.zip

# 解压
unzip commandlinetools-mac-9477386_latest.zip
mv cmdline-tools latest
mkdir cmdline-tools
mv latest cmdline-tools/
```

### 2. 安装必要的SDK组件

```bash
# 设置环境变量
export ANDROID_HOME=~/Library/Android/sdk
export PATH=$PATH:$ANDROID_HOME/cmdline-tools/latest/bin

# 接受许可证
yes | sdkmanager --licenses

# 安装必要组件
sdkmanager "platform-tools" "platforms;android-34" "build-tools;34.0.0"
```

## ✅ 验证安装

### 检查环境变量

```bash
# 检查ANDROID_HOME
echo $ANDROID_HOME

# 检查adb
adb version

# 检查Java
java -version
```

### 测试构建

```bash
# 进入项目目录
cd /Users/sean/Documents/aicode/哈友工具箱2.5.0/BypassApp

# 运行构建脚本
./build_apk.sh debug
```

## 🐛 常见问题解决

### 问题1：ANDROID_HOME未设置

**解决方案**：
```bash
# 找到Android SDK位置
find /Applications -name "sdk" -type d 2>/dev/null
find ~/Library -name "Android" -type d 2>/dev/null

# 设置正确的路径
export ANDROID_HOME=/path/to/your/android/sdk
```

### 问题2：Java版本不兼容

**解决方案**：
```bash
# 安装Java 11
brew install openjdk@11

# 设置Java环境
export JAVA_HOME=/usr/local/opt/openjdk@11
export PATH=$JAVA_HOME/bin:$PATH
```

### 问题3：权限问题

**解决方案**：
```bash
# 给脚本执行权限
chmod +x ./build_apk.sh
chmod +x ./gradlew

# 如果需要，修复SDK权限
sudo chown -R $(whoami) $ANDROID_HOME
```

### 问题4：网络连接问题

**解决方案**：
```bash
# 配置代理（如果需要）
export GRADLE_OPTS="-Dhttp.proxyHost=your.proxy.host -Dhttp.proxyPort=8080"

# 或使用国内镜像
# 编辑 ~/.gradle/gradle.properties
mkdir -p ~/.gradle
echo "systemProp.http.proxyHost=mirrors.neusoft.edu.cn" >> ~/.gradle/gradle.properties
echo "systemProp.http.proxyPort=80" >> ~/.gradle/gradle.properties
```

## 📱 一键安装脚本

创建自动安装脚本：

```bash
#!/bin/bash
# 保存为 install_android_env.sh

set -e

echo "🚀 开始安装Android开发环境..."

# 检查Homebrew
if ! command -v brew &> /dev/null; then
    echo "📦 安装Homebrew..."
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
fi

# 安装Java
echo "☕ 安装Java..."
brew install openjdk@11

# 安装Android Studio
echo "📱 安装Android Studio..."
brew install --cask android-studio

# 设置环境变量
echo "⚙️ 配置环境变量..."
echo 'export JAVA_HOME=/usr/local/opt/openjdk@11' >> ~/.zshrc
echo 'export ANDROID_HOME=$HOME/Library/Android/sdk' >> ~/.zshrc
echo 'export PATH=$PATH:$ANDROID_HOME/tools:$ANDROID_HOME/platform-tools' >> ~/.zshrc

echo "✅ 安装完成！"
echo "请重启终端或运行: source ~/.zshrc"
echo "然后启动Android Studio完成SDK安装"
```

## 🎯 下一步

安装完成后：

1. **重启终端**
2. **验证环境**：`echo $ANDROID_HOME`
3. **运行构建**：`./build_apk.sh debug`
4. **安装APK**：`adb install app-debug.apk`

---

**提示**：如果遇到问题，请检查每个步骤的输出信息，大多数问题都与路径配置有关。